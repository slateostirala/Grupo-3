<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Manual ownCloud Upgrade &#8212; ownCloud 10.0.10 Server Administration Manual 10.0.10 documentation</title>
    <link rel="stylesheet" href="../_static/" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/main.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/styles.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '10.0.10',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.1.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Restoring ownCloud" href="restore.html" />
    <link rel="prev" title="Upgrading ownCloud with the Updater App" href="update.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="theme-color" content="#1d2d44">

  </head>
  <body>


<div class="wrap container not-front">
  <div class="content row">
  <main class="main">
    <div class="row page-content-header">
      <div class="col-md-5 col-md-offset-7">
      
        <form class="headersearch" style="margin-bottom:-3px;" action="../search.html" method="get">
        <input type="text" value="" name="q" id="q" class="form-control" /> 
        <button  class="btn btn-default" type="submit" id="searchsubmit">Search</button>
        </form>
      
      </div>
    </div>
    
			<div class="row">
				<div class="col-md-3">
					<div class="sidebar">
							<div class="menu-support-container">
								<ul id="menu-support" class="menu">
									<ul>
										
<li><a href="../contents.html">Table of Contents</a></li>
									</ul>
                  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release_notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../whats_new_admin.html">What’s New in ownCloud 10.0.10</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation/index.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../upgrading/index.html">Upgrading</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration/index.html">Configuration</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Maintenance</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="enable_maintenance.html">Maintenance Mode Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="backup.html">Backing up ownCloud</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrade.html">How to Upgrade Your ownCloud Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="package_upgrade.html">Upgrade ownCloud From Packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="update.html">Upgrading ownCloud with the Updater App</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Manual ownCloud Upgrade</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#backup-your-existing-installation">Backup Your Existing Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#review-third-party-apps">Review Third-Party Apps</a></li>
<li class="toctree-l3"><a class="reference internal" href="#check-owncloud-s-mandatory-requirements">Check ownCloud’s Mandatory Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="#enable-maintenance-mode">Enable Maintenance Mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="#stop-the-webserver">Stop the Webserver</a></li>
<li class="toctree-l3"><a class="reference internal" href="#download-the-latest-installation">Download the Latest Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#setup-the-new-installation">Setup the New Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#disable-core-apps">Disable Core Apps</a></li>
<li class="toctree-l3"><a class="reference internal" href="#market-and-marketplace-app-upgrades">Market and Marketplace App Upgrades</a></li>
<li class="toctree-l3"><a class="reference internal" href="#start-the-upgrade">Start the Upgrade</a></li>
<li class="toctree-l3"><a class="reference internal" href="#copy-old-apps">Copy Old Apps</a></li>
<li class="toctree-l3"><a class="reference internal" href="#disable-maintenance-mode">Disable Maintenance Mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="#restart-the-webserver">Restart the Webserver</a></li>
<li class="toctree-l3"><a class="reference internal" href="#finalize-the-installation">Finalize the Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#test-the-upgrade">Test the Upgrade</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reverse-upgrade">Reverse Upgrade</a></li>
<li class="toctree-l3"><a class="reference internal" href="#troubleshooting">Troubleshooting</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="restore.html">Restoring ownCloud</a></li>
<li class="toctree-l2"><a class="reference internal" href="migrating.html">Migrating to a Different Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="manually-moving-data-folders.html">How To Manually Move a Data Directory</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../issues/index.html">Issues and Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../enterprise/index.html">Enterprise Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appliance/index.html">The ownCloud X Appliance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/index.html">FAQ</a></li>
</ul>

								</ul>
							</div>
					</div>
				</div>
        

				<div class="col-md-9">
					<div class="page-content">
            
<ul class="prevnext-title list-unstyled list-inline">
  <li class="prev">
    <a href="update.html" title="Previous Chapter: Upgrading ownCloud with the Updater App"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm">&laquo; Upgrading own...</span>
    </a>
  </li>
  <li class="next">
    <a href="restore.html" title="Next Chapter: Restoring ownCloud"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm">Restoring ownCloud &raquo;</span>
    </a>
  </li>
</ul>
						
  <div class="section" id="manual-owncloud-upgrade">
<h1>Manual ownCloud Upgrade<a class="headerlink" href="#manual-owncloud-upgrade" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you’re not comfortable performing a manual upgrade, you can also use your
Linux distribution’s <a class="reference internal" href="package_upgrade.html"><span class="doc">package manager</span></a>, or use
<a class="reference internal" href="update.html"><span class="doc">the Updater App</span></a>.</p>
</div>
<div class="section" id="backup-your-existing-installation">
<h2>Backup Your Existing Installation<a class="headerlink" href="#backup-your-existing-installation" title="Permalink to this headline">¶</a></h2>
<p>First, <a class="reference internal" href="backup.html"><span class="doc">backup</span></a> the following items:</p>
<ul class="simple">
<li>The ownCloud server data directory</li>
<li>The <code class="docutils literal"><span class="pre">config.php</span></code> file</li>
<li>All 3rd party apps</li>
<li>The ownCloud server database</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># This example assumes Ubuntu Linux and MariaDB</span>
<span class="n">cp</span> <span class="o">-</span><span class="n">rv</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">owncloud</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">backup</span><span class="o">/</span><span class="n">owncloud</span> <span class="o">&amp;&amp;</span> <span class="n">mysqldump</span> <span class="o">&lt;</span><span class="n">db_name</span><span class="o">&gt;</span> <span class="o">&gt;</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">backup</span><span class="o">/</span><span class="n">backup</span><span class="o">-</span><span class="n">file</span><span class="o">.</span><span class="n">sql</span>
</pre></div>
</div>
</div>
<div class="section" id="review-third-party-apps">
<h2>Review Third-Party Apps<a class="headerlink" href="#review-third-party-apps" title="Permalink to this headline">¶</a></h2>
<p>Review any installed third-party apps for compatibility with the new ownCloud release.
Ensure that they are all disabled before beginning the upgrade.
After the upgrade is complete re-enable any which are compatible with the new release.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Install unsupported apps at your own risk.</p>
</div>
</div>
<div class="section" id="check-owncloud-s-mandatory-requirements">
<h2>Check ownCloud’s Mandatory Requirements<a class="headerlink" href="#check-owncloud-s-mandatory-requirements" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="../installation/source_installation.html#prerequisites-label"><span class="std std-ref">ownCloud’s mandatory requirements</span></a> (such as PHP versions and extensions) can change from one version to the next.
Ensure that you review them and update your server(s), if required, before upgrading ownCloud.</p>
</div>
<div class="section" id="enable-maintenance-mode">
<h2>Enable Maintenance Mode<a class="headerlink" href="#enable-maintenance-mode" title="Permalink to this headline">¶</a></h2>
<p>Put your server in <a class="reference internal" href="enable_maintenance.html"><span class="doc">maintenance mode</span></a> and disable <a class="reference internal" href="../configuration/server/background_jobs_configuration.html#cron-job-label"><span class="std std-ref">Cron jobs</span></a>.</p>
<p>Doing so prevents new logins, locks the sessions of logged-in users, and displays a status screen so that users know what is happening.</p>
<p>There are two ways to enable maintenance mode.
The preferred method is to use the <a class="reference internal" href="../configuration/server/occ_command.html"><span class="doc">occ command</span></a> — which you must run as your webserver user.
The other way is by entering your <code class="docutils literal"><span class="pre">config.php</span></code> file and changing <code class="docutils literal"><span class="pre">'maintenance'</span> <span class="pre">=&gt;</span> <span class="pre">false,</span></code> to <code class="docutils literal"><span class="pre">'maintenance'</span> <span class="pre">=&gt;</span> <span class="pre">true,</span></code>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># Enable maintenance mode using the occ command.</span>
<span class="n">sudo</span> <span class="o">-</span><span class="n">u</span> <span class="n">www</span><span class="o">-</span><span class="n">data</span> <span class="n">php</span> <span class="n">occ</span> <span class="n">maintenance</span><span class="p">:</span><span class="n">mode</span> <span class="o">--</span><span class="n">on</span>

<span class="c1"># Disable Cron jobs</span>
<span class="n">sudo</span> <span class="n">service</span> <span class="n">cron</span> <span class="n">stop</span>
</pre></div>
</div>
</div>
<div class="section" id="stop-the-webserver">
<h2>Stop the Webserver<a class="headerlink" href="#stop-the-webserver" title="Permalink to this headline">¶</a></h2>
<p>With those steps completed, stop your webserver.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">service</span> <span class="n">apache2</span> <span class="n">stop</span>
</pre></div>
</div>
</div>
<div class="section" id="download-the-latest-installation">
<h2>Download the Latest Installation<a class="headerlink" href="#download-the-latest-installation" title="Permalink to this headline">¶</a></h2>
<p>Download the latest ownCloud server release from <a class="reference external" href="https://owncloud.org/install/">owncloud.org/install/</a> into an empty directory <strong>outside</strong> of your current installation.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Enterprise users must download their new ownCloud archives from their accounts on <a class="reference external" href="https://customer.owncloud.com/owncloud/">https://customer.owncloud.com/owncloud/</a>.</p>
</div>
</div>
<div class="section" id="setup-the-new-installation">
<h2>Setup the New Installation<a class="headerlink" href="#setup-the-new-installation" title="Permalink to this headline">¶</a></h2>
<p>Not all installations are the same, so we encourage you to take one of two paths to upgrade your ownCloud installation.
These are <a class="reference internal" href="#the-standard-upgrade">the standard upgrade</a> and <a class="reference internal" href="#the-power-user-upgrade">the power user upgrade</a>.</p>
<p>If you’re reasonably new to ownCloud, or not too familiar with upgrading an ownCloud installation, please follow the standard upgrade.
Otherwise, take the approach that you’re most comfortable with, likely the power
user upgrade.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Regardless of which approach that you take, they will both assume that your existing ownCloud installation is located in the default location: <code class="docutils literal"><span class="pre">/var/www/owncloud</span></code>.</p>
</div>
<div class="section" id="the-standard-upgrade">
<h3>The Standard Upgrade<a class="headerlink" href="#the-standard-upgrade" title="Permalink to this headline">¶</a></h3>
<p>Delete all files and folders in your existing ownCloud directory (<code class="docutils literal"><span class="pre">/var/www/owncloud</span></code>) —&nbsp;<strong>except</strong> <code class="docutils literal"><span class="pre">data</span></code> and <code class="docutils literal"><span class="pre">config</span></code>.</p>
<div class="admonition attention">
<p class="first admonition-title">Attention</p>
<p class="last">Don’t keep the <code class="docutils literal"><span class="pre">apps</span></code> directory.</p>
</div>
<p>With those files and folders deleted, extract the archive of the latest ownCloud server, over the top of your existing installation.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># Extract the .tar.bz2 archive</span>
<span class="n">tar</span> <span class="o">-</span><span class="n">jxf</span> <span class="n">owncloud</span><span class="o">-</span><span class="mf">10.0</span><span class="o">.</span><span class="mf">3.</span><span class="n">tar</span><span class="o">.</span><span class="n">bz2</span> <span class="o">-</span><span class="n">C</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span>

<span class="c1"># Extract the zip archive</span>
<span class="n">unzip</span> <span class="o">-</span><span class="n">q</span> <span class="n">owncloud</span><span class="o">-</span><span class="mf">10.0</span><span class="o">.</span><span class="mf">3.</span><span class="n">zip</span> <span class="o">-</span><span class="n">d</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span>
</pre></div>
</div>
</div>
<div class="section" id="the-power-user-upgrade">
<h3>The Power User Upgrade<a class="headerlink" href="#the-power-user-upgrade" title="Permalink to this headline">¶</a></h3>
<p>Rename your current ownCloud directory, for example, from <code class="docutils literal"><span class="pre">owncloud</span></code> to <code class="docutils literal"><span class="pre">owncloud-old</span></code>.
Extract the unpacked ownCloud server directory and its contents to the location of your original ownCloud installation.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># Assumes that the new release was unpacked into /tmp/</span>
<span class="n">mv</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">owncloud</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span>
</pre></div>
</div>
<p>With the new source files now in place of the old ones, next copy the <code class="docutils literal"><span class="pre">config.php</span></code> file from your old ownCloud directory to your new ownCloud directory.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cp</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">owncloud</span><span class="o">-</span><span class="n">old</span><span class="o">/</span><span class="n">config</span><span class="o">/</span><span class="n">config</span><span class="o">.</span><span class="n">php</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">owncloud</span><span class="o">/</span><span class="n">config</span><span class="o">/</span><span class="n">config</span><span class="o">.</span><span class="n">php</span>
</pre></div>
</div>
<p>If you keep your <code class="docutils literal"><span class="pre">data/</span></code> directory <em>inside</em> your <code class="docutils literal"><span class="pre">owncloud/</span></code> directory, copy it from your old version of ownCloud to your new version.
If you keep it <em>outside</em> of your <code class="docutils literal"><span class="pre">owncloud/</span></code> directory, then you don’t have to do anything with it, because its location is configured in your original <code class="docutils literal"><span class="pre">config.php</span></code>, and none of the upgrade steps touch it.</p>
</div>
</div>
<div class="section" id="disable-core-apps">
<h2>Disable Core Apps<a class="headerlink" href="#disable-core-apps" title="Permalink to this headline">¶</a></h2>
<p>Before the upgrade can run, several apps need to be disabled, if they’re enabled, before the upgrade can succeed.
These are: <em>activity</em>, <em>files_pdfviewer</em>, <em>files_texteditor</em>, and <em>gallery</em>.
The following command provides an example of how to do so.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="o">-</span><span class="n">u</span> <span class="n">www</span><span class="o">-</span><span class="n">data</span> <span class="n">php</span> <span class="n">occ</span> <span class="n">app</span><span class="p">:</span><span class="n">disable</span> <span class="n">activity</span>
<span class="n">sudo</span> <span class="o">-</span><span class="n">u</span> <span class="n">www</span><span class="o">-</span><span class="n">data</span> <span class="n">php</span> <span class="n">occ</span> <span class="n">app</span><span class="p">:</span><span class="n">disable</span> <span class="n">files_pdfviewer</span>
<span class="n">sudo</span> <span class="o">-</span><span class="n">u</span> <span class="n">www</span><span class="o">-</span><span class="n">data</span> <span class="n">php</span> <span class="n">occ</span> <span class="n">app</span><span class="p">:</span><span class="n">disable</span> <span class="n">files_texteditor</span>
<span class="n">sudo</span> <span class="o">-</span><span class="n">u</span> <span class="n">www</span><span class="o">-</span><span class="n">data</span> <span class="n">php</span> <span class="n">occ</span> <span class="n">app</span><span class="p">:</span><span class="n">disable</span> <span class="n">gallery</span>
</pre></div>
</div>
</div>
<div class="section" id="market-and-marketplace-app-upgrades">
<h2>Market and Marketplace App Upgrades<a class="headerlink" href="#market-and-marketplace-app-upgrades" title="Permalink to this headline">¶</a></h2>
<p>Before getting too far into the upgrade process, please be aware of how the Market app and its configuration options affect the upgrade process.</p>
<ul class="simple">
<li>The Market app is not upgraded if it is either disabled (because <code class="docutils literal"><span class="pre">appstoreenabled</span></code> is set to <code class="docutils literal"><span class="pre">false</span></code>) or it is not available.</li>
<li>If <code class="docutils literal"><span class="pre">upgrade.automatic-app-update</span></code> is set to <code class="docutils literal"><span class="pre">false</span></code> apps installed from the Marketplace are not automatically upgraded.</li>
</ul>
<p>In addition to these two points, if there are installed apps (whether compatible or incompatible with the next version, or missing source code) and the Market app is enabled, but there is no available internet connection, then these apps will need to be manually updated once the upgrade is finished.</p>
</div>
<div class="section" id="start-the-upgrade">
<h2>Start the Upgrade<a class="headerlink" href="#start-the-upgrade" title="Permalink to this headline">¶</a></h2>
<p>With the apps disabled and the webserver started, launch the upgrade process from the command line.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># Here is an example on CentOS Linux</span>
<span class="n">sudo</span> <span class="o">-</span><span class="n">u</span> <span class="n">www</span><span class="o">-</span><span class="n">data</span> <span class="n">php</span> <span class="n">occ</span> <span class="n">upgrade</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The optional parameter to skip migration tests during this step was removed in oC 10.0.
See <a class="reference internal" href="#migration-test-label"><span class="std std-ref">Test the Upgrade</span></a> for background information.
See <a class="reference internal" href="../configuration/server/occ_command.html"><span class="doc">Using occ core commands</span></a> to learn more about the occ command.</p>
</div>
<p>The upgrade operation can take anywhere from a few minutes to a few hours, depending on the size of your installation.
When it is finished you will see either a success message, or an error message which indicates why the process did not complete successfully.</p>
</div>
<div class="section" id="copy-old-apps">
<h2>Copy Old Apps<a class="headerlink" href="#copy-old-apps" title="Permalink to this headline">¶</a></h2>
<p>If you are using 3rd party applications, look in your new <code class="docutils literal"><span class="pre">/var/www/owncloud/apps/</span></code> directory to see if they are there.
If not, copy them from your old <code class="docutils literal"><span class="pre">apps/</span></code> directory to your new one, and make sure that the directory permissions are the same as for the other ones.</p>
</div>
<div class="section" id="disable-maintenance-mode">
<h2>Disable Maintenance Mode<a class="headerlink" href="#disable-maintenance-mode" title="Permalink to this headline">¶</a></h2>
<p>Assuming your upgrade succeeded, next disable maintenance mode.
The simplest way is by using occ from the command line.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="o">-</span><span class="n">u</span> <span class="n">www</span><span class="o">-</span><span class="n">data</span> <span class="n">php</span> <span class="n">occ</span> <span class="n">maintenance</span><span class="p">:</span><span class="n">mode</span> <span class="o">--</span><span class="n">off</span>
</pre></div>
</div>
</div>
<div class="section" id="restart-the-webserver">
<h2>Restart the Webserver<a class="headerlink" href="#restart-the-webserver" title="Permalink to this headline">¶</a></h2>
<p>With all that done, restart your web server.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">service</span> <span class="n">apache2</span> <span class="n">start</span>
</pre></div>
</div>
</div>
<div class="section" id="finalize-the-installation">
<h2>Finalize the Installation<a class="headerlink" href="#finalize-the-installation" title="Permalink to this headline">¶</a></h2>
<p>With maintenance mode disabled, login and:</p>
<ul class="simple">
<li>Check that the version number reflects the new installation. It’s visible at the bottom of your Admin page.</li>
<li>Check that your other settings are correct.</li>
<li>Go to the Apps page and review the core apps to make sure the right ones are enabled.</li>
<li>Re-enable your third-party apps.</li>
<li><a class="reference internal" href="../installation/source_installation.html#strong-perms-label"><span class="std std-ref">Apply strong permissions</span></a> to your ownCloud directories.</li>
</ul>
</div>
<div class="section" id="test-the-upgrade">
<span id="migration-test-label"></span><h2>Test the Upgrade<a class="headerlink" href="#test-the-upgrade" title="Permalink to this headline">¶</a></h2>
<p>Previous versions of ownCloud included a migration test.
ownCloud first ran a migration simulation by copying the ownCloud database and performing the upgrade on the copy, to ensure that the migration would succeed.</p>
<p>Then the copied tables were deleted after the upgrade was completed.
This doubled the upgrade time, so admins could skip this test (by risking a failed upgrade) with <code class="docutils literal"><span class="pre">php</span> <span class="pre">occ</span> <span class="pre">upgrade</span> <span class="pre">--skip-migration-test</span></code>.</p>
<p>The migration test has been removed from ownCloud 9.2. ownCloud server admins should have current backups before migration, and rely on backups to correct any problems from the migration.</p>
</div>
<div class="section" id="reverse-upgrade">
<h2>Reverse Upgrade<a class="headerlink" href="#reverse-upgrade" title="Permalink to this headline">¶</a></h2>
<p>If you need to reverse your upgrade, see <a class="reference internal" href="restore.html"><span class="doc">Restoring ownCloud</span></a>.</p>
</div>
<div class="section" id="troubleshooting">
<h2>Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permalink to this headline">¶</a></h2>
<p>When upgrading ownCloud and you are running MySQL or MariaDB with binary logging enabled, your upgrade may fail with these errors in your MySQL/MariaDB log:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">An</span> <span class="n">unhandled</span> <span class="n">exception</span> <span class="n">has</span> <span class="n">been</span> <span class="n">thrown</span><span class="p">:</span>
<span class="n">exception</span> <span class="s1">&#39;PDOException&#39;</span> <span class="k">with</span> <span class="n">the</span> <span class="n">message</span> <span class="s1">&#39;SQLSTATE[HY000]: General error: 1665</span>
<span class="n">Cannot</span> <span class="n">execute</span> <span class="n">statement</span><span class="p">:</span> <span class="n">impossible</span> <span class="n">to</span> <span class="n">write</span> <span class="n">to</span> <span class="n">binary</span> <span class="n">log</span> <span class="n">since</span>
<span class="n">BINLOG_FORMAT</span> <span class="o">=</span> <span class="n">STATEMENT</span> <span class="ow">and</span> <span class="n">at</span> <span class="n">least</span> <span class="n">one</span> <span class="n">table</span> <span class="n">uses</span> <span class="n">a</span> <span class="n">storage</span> <span class="n">engine</span> <span class="n">limited</span> <span class="n">to</span> <span class="n">row</span><span class="o">-</span><span class="n">based</span> <span class="n">logging</span><span class="o">.</span> <span class="n">InnoDB</span> <span class="ow">is</span> <span class="n">limited</span> <span class="n">to</span> <span class="n">row</span><span class="o">-</span><span class="n">logging</span> <span class="n">when</span> <span class="n">transaction</span> <span class="n">isolation</span> <span class="n">level</span> <span class="ow">is</span> <span class="n">READ</span> <span class="n">COMMITTED</span> <span class="ow">or</span> <span class="n">READ</span> <span class="n">UNCOMMITTED</span><span class="o">.</span><span class="s1">&#39;</span>
</pre></div>
</div>
<p>Please refer to <a class="reference internal" href="../configuration/database/linux_database_configuration.html#db-binlog-label"><span class="std std-ref">MySQL / MariaDB with Binary Logging Enabled</span></a> on how to correctly configure your environment.</p>
<p>Occasionally, <em>files do not show up after an upgrade</em>. A rescan of the files can help:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="o">-</span><span class="n">u</span> <span class="n">www</span><span class="o">-</span><span class="n">data</span> <span class="n">php</span> <span class="n">console</span><span class="o">.</span><span class="n">php</span> <span class="n">files</span><span class="p">:</span><span class="n">scan</span> <span class="o">--</span><span class="nb">all</span>
</pre></div>
</div>
<p>See <a class="reference external" href="https://owncloud.org/support">the owncloud.org support page</a> for further resources for both home and enterprise users.</p>
<p>Sometimes, ownCloud can get <em>stuck in a upgrade</em>.
This is usually due to the process taking too long and encountering a PHP time-out. Stop the upgrade process this way:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="o">-</span><span class="n">u</span> <span class="n">www</span><span class="o">-</span><span class="n">data</span> <span class="n">php</span> <span class="n">occ</span> <span class="n">maintenance</span><span class="p">:</span><span class="n">mode</span> <span class="o">--</span><span class="n">off</span>
</pre></div>
</div>
<p>Then start the manual process:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="o">-</span><span class="n">u</span> <span class="n">www</span><span class="o">-</span><span class="n">data</span> <span class="n">php</span> <span class="n">occ</span> <span class="n">upgrade</span>
</pre></div>
</div>
<p>If this does not work properly, try the repair function:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="o">-</span><span class="n">u</span> <span class="n">www</span><span class="o">-</span><span class="n">data</span> <span class="n">php</span> <span class="n">occ</span> <span class="n">maintenance</span><span class="p">:</span><span class="n">repair</span>
</pre></div>
</div>
</div>
</div>


            
<ul class="prevnext-title list-unstyled list-inline">
  <li class="prev">
    <a href="update.html" title="Previous Chapter: Upgrading ownCloud with the Updater App"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm">&laquo; Upgrading own...</span>
    </a>
  </li>
  <li class="next">
    <a href="restore.html" title="Next Chapter: Restoring ownCloud"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm">Restoring ownCloud &raquo;</span>
    </a>
  </li>
</ul>
					</div>
				</div>
			</div>
  </main>  
  </div>
</div>
  </body>
</html>